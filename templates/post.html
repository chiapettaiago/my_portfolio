{% extends 'base.html' %}
{% block title %}{{ post.title }}{% endblock %}
{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-8">
            <article class="blog-post">
                <h1 class="blog-post-title">{{ post.title }}</h1>
                <p class="blog-post-meta text-muted">
                    {{ post.created_at }} por {{ post.user }}
                </p>
                {% if post.main_image %}
                <img src="{{ url_for('static', filename='uploads/' + post.main_image) }}" class="img-fluid mb-4" alt="{{ post.title }}">
                {% endif %}
                <div class="blog-post-content">
                    {{ post.content|safe }}
                </div>
                
                <!-- Botão de Doação -->
                <div class="donation-section text-center my-5 p-4 bg-light rounded">
                    <h4>Gostou do conteúdo?</h4>
                    <p class="text-muted mb-3">Se este post foi útil para você, considere fazer uma doação para apoiar o trabalho!</p>
                    <a href="https://donatehub.chiapettadev.site/payment/chiapettaiago" target="_blank" class="btn btn-success btn-lg">
                        <i class="fas fa-heart"></i> Fazer uma Doação
                    </a>
                </div>
            </article>

            <!-- Seção de Comentários -->
            {% include 'comments.html' %}
        </div>

        <div class="col-md-4">
            <div class="recent-posts">
                <h3>Posts Recentes</h3>
                {% for recent_post in recent_posts %}
                <div class="card mb-3">
                    {% if recent_post.main_image %}
                    <img src="{{ url_for('static', filename='uploads/' + recent_post.main_image) }}" class="card-img-top" alt="{{ recent_post.title }}">
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title">{{ recent_post.title }}</h5>
                        <p class="card-text">{{ recent_post.content[:100] | safe }}...</p>
                        <a href="{{ url_for('post_view', post_id=recent_post.id) }}" class="btn btn-primary">Ler mais</a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<script>
  tinymce.init({
    selector: 'textarea',
    language: 'pt_BR',
    plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount',
    toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat',
    setup(editor){ editor.on('change',()=> tinymce.triggerSave()) }
  });
</script>
{% endblock %}
